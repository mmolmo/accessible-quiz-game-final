<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Quiz Game</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <main>
        <h1>Quiz Game</h1>
        <div id="game-container" role="region" aria-live="polite">
            <div id="character">
                <img id="character-img" src="https://via.placeholder.com/150?text=Neutral" alt="Quiz Character Neutral Expression">
                <p id="character-dialogue" aria-live="polite"></p>
            </div>
            <div id="timer">Time Left: <span id="time">30</span>s</div>
            <div id="question-container" hidden>
                <h2 id="question"></h2>
                <ul id="answers"></ul>
            </div>
            <div id="feedback" aria-live="assertive"></div>
            <button id="start-btn">Start Game</button>
            <div id="results" hidden>
                <p id="score"></p>
                <div id="rewards"></div>
                <button id="restart-btn">Play Again</button>
            </div>
        </div>
    </main>
    <script src="script.js"></script>
</body>
</html>

/* Character styling */
#character {
    text-align: center;
    margin-bottom: 20px;
}

#character-img {
    max-width: 150px;
    margin-bottom: 10px;
    transition: opacity 0.5s ease;
}

#character-dialogue {
    font-size: 1rem;
    font-style: italic;
}

/* Rewards section */
#rewards img {
    max-width: 100px;
    margin: 5px;
    display: inline-block;
}

#rewards p {
    margin-top: 10px;
}

/* Existing styles */
body {
    font-family: Arial, sans-serif;
    line-height: 1.6;
    margin: 0;
    padding: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    background: #f4f4f4;
    color: #333;
}

main {
    text-align: center;
    background: #fff;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    width: 300px;
}

#timer {
    font-size: 1.2rem;
    margin-bottom: 20px;
}

/* Rest is the same as before */

#answers {
    list-style: none;
    padding: 0;
}

#answers li {
    margin: 10px 0;
    cursor: pointer;
    padding: 10px;
    background: #007bff;
    color: #fff;
    border-radius: 4px;
    transition: background 0.3s ease;
}

#answers li:focus {
    outline: 2px solid #0056b3;
}

#answers li:hover {
    background: #0056b3;
}

button {
    padding: 10px 20px;
    border: none;
    background: #007bff;
    color: #fff;
    border-radius: 4px;
    cursor: pointer;
}

button:hover {
    background: #0056b3;
}

#results {
    margin-top: 20px;
}

document.addEventListener("DOMContentLoaded", () => {
    const startButton = document.getElementById("start-btn");
    const questionContainer = document.getElementById("question-container");
    const answersList = document.getElementById("answers");
    const feedback = document.getElementById("feedback");
    const timerDisplay = document.getElementById("time");
    const results = document.getElementById("results");
    const scoreDisplay = document.getElementById("score");
    const restartButton = document.getElementById("restart-btn");
    const characterImg = document.getElementById("character-img");
    const characterDialogue = document.getElementById("character-dialogue");
    const rewardsContainer = document.getElementById("rewards");

    const characterExpressions = {
        neutral: "https://via.placeholder.com/150?text=Neutral",
        joyful: "https://via.placeholder.com/150?text=Joyful",
        encouraging: "https://via.placeholder.com/150?text=Encouraging",
    };

    const rewards = [
        { score: 30, image: "https://via.placeholder.com/100?text=Bronze+Reward" },
        { score: 60, image: "https://via.placeholder.com/100?text=Silver+Reward" },
        { score: 90, image: "https://via.placeholder.com/100?text=Gold+Reward" },
    ];

    const questions = [
        {
            question: "What is the capital of France?",
            answers: ["Paris", "Berlin", "Madrid", "Rome"],
            correct: 0,
        },
        {
            question: "What is 5 + 3?",
            answers: ["5", "7", "8", "9"],
            correct: 2,
        },
        {
            question: "Which planet is known as the Red Planet?",
            answers: ["Earth", "Venus", "Mars", "Jupiter"],
            correct: 2,
        },
    ];

    let currentQuestionIndex = 0;
    let score = 0;
    let timer = 30;
    let timerInterval;
    let correctAnswers = 0;

    startButton.addEventListener("click", startGame);
    restartButton.addEventListener("click", startGame);

    function startGame() {
        characterDialogue.textContent = "Welcome! Let's start the quiz. Good luck!";
        characterImg.src = characterExpressions.neutral;

        currentQuestionIndex = 0;
        score = 0;
        correctAnswers = 0;
        timer = 30;
        results.hidden = true;
        startButton.hidden = true;
        questionContainer.hidden = false;
        feedback.textContent = "";
        rewardsContainer.innerHTML = "";
        updateTimer();
        timerInterval = setInterval(updateTimer, 1000);
        showQuestion();
    }

    function updateTimer() {
        timer--;
        timerDisplay.textContent = timer;
        if (timer <= 0) {
            endGame();
        }
    }

    function showQuestion() {
        const questionData = questions[currentQuestionIndex];
        characterDialogue.textContent = "Here comes your question!";
        characterImg.src = characterExpressions.neutral;

        document.getElementById("question").textContent = questionData.question;
        answersList.innerHTML = "";

        questionData.answers.forEach((answer, index) => {
            const li = document.createElement("li");
            li.textContent = answer;
            li.tabIndex = 0;
            li.addEventListener("click", () => handleAnswer(index));
            li.addEventListener("keydown", (e) => {
                if (e.key === "Enter" || e.key === " ") {
                    handleAnswer(index);
                }
            });
            answersList.appendChild(li);
        });
    }

    function handleAnswer(selectedIndex) {
        const questionData = questions[currentQuestionIndex];
    
        // Check the selected answer
        if (selectedIndex === questionData.correct) {
            feedback.textContent = "Correct!";
            characterDialogue.textContent = "Great job! You got it right!";
            characterImg.src = characterExpressions.joyful;
            score += timer; // Bonus for answering quickly
            correctAnswers++;
        } else {
            feedback.textContent = "Incorrect.";
            characterDialogue.textContent = `Oops! The correct answer was "${questionData.answers[questionData.correct]}". Try the next one!`;
            characterImg.src = characterExpressions.encouraging;
        }
    
        // Show the updated expression for 2 seconds, then revert to neutral
        setTimeout(() => {
            characterImg.src = characterExpressions.neutral;
        }, 2000);
    
        // Move to the next question after a delay
        setTimeout(() => {
            if (++currentQuestionIndex < questions.length) {
                showQuestion();
            } else {
                endGame();
            }
        }, 2000); // Ensures expressions stay visible before the next question
    }
    


    function endGame() {
        clearInterval(timerInterval);
        questionContainer.hidden = true;
        results.hidden = false;

        scoreDisplay.textContent = `Your score: ${score}`;
        characterDialogue.textContent = correctAnswers === 0
            ? "Keep trying! You'll get it next time!"
            : `Well done! You got ${correctAnswers} out of ${questions.length} correct.`;

        const reward = rewards.find(r => score >= r.score) || { image: "https://via.placeholder.com/100?text=No+Reward" };
        rewardsContainer.innerHTML = `<img src="${reward.image}" alt="Reward">`;
    }
});
